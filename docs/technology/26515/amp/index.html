<!doctype html>
<html amp lang="zh-TW">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1">
	<script type='application/ld+json' class='yoast-schema-graph yoast-schema-graph--main'>{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://daynews.cc/#website","url":"https://daynews.cc/","name":"\u5929\u5929\u8981\u805e","description":"\u4e00\u7db2\u6253\u76e1\u5168\u7db2\u6700\u65b0\u8cc7\u8a0a\u6700\u71b1\u982d\u689d\u65b0","potentialAction":{"@type":"SearchAction","target":"https://daynews.cc/?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"ImageObject","@id":"https://daynews.cc/technology/26515/#primaryimage","url":"http://p3.pstatp.com/large/pgc-image/Ra368aR1KcTeVl"},{"@type":"WebPage","@id":"https://daynews.cc/technology/26515/#webpage","url":"https://daynews.cc/technology/26515/","inLanguage":"zh-TW","name":"\u9a30\u8a0aAngel\u5347\u7d1a\uff1a\u52a0\u5165\u5716\u6f14\u7b97\u6cd5\uff0c\u652f\u6301\u5341\u5104\u7bc0\u9ede\u3001\u5343\u5104\u908a\u898f\u6a21\uff01\u4e2d\u570b\u9996\u500b\u7562\u696d\u65bcLinux AI\u57fa\u91d1\u6703\u7684\u958b\u6e90\u9805\u76ee - \u5929\u5929\u8981\u805e","isPartOf":{"@id":"https://daynews.cc/#website"},"primaryImageOfPage":{"@id":"https://daynews.cc/technology/26515/#primaryimage"},"datePublished":"2019-12-22T05:15:12+00:00","dateModified":"2019-12-22T05:15:12+00:00","author":{"@id":"https://daynews.cc/#/schema/person/038ceb5ed68cf11f9ec94ba43c7ff55d"}},{"@type":["Person"],"@id":"https://daynews.cc/#/schema/person/038ceb5ed68cf11f9ec94ba43c7ff55d","name":"\u5929\u5929\u8981\u805e","image":{"@type":"ImageObject","@id":"https://daynews.cc/#authorlogo","url":"https://secure.gravatar.com/avatar/e786821a74ef0467825a7d60183307bc?s=96&d=mm&r=g","caption":"\u5929\u5929\u8981\u805e"},"sameAs":[]}]}</script>
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="出品 | AI科技大本營（ID：rgznai100） 【導語】Angel 是騰訊的首個AI開源項目，於 2016 年底推出、2017年開源。近日，快速發展的 Angel 完成了從 2.0 版本到 3.0 版本的跨越，從一個單純的模型訓練系統進化成包含從自動特徵工程到模型服務的全棧機器學習平台。作為面向機器學習的第三代高性能計算平台，Ang……" />
<meta name="twitter:title" content="騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目 - 天天要聞" />
<meta name="twitter:image" content="http://p3.pstatp.com/large/pgc-image/Ra368aR1KcTeVl" />
<meta property="og:locale" content="zh_TW" />
<meta property="og:type" content="article" />
<meta property="og:title" content="騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目 - 天天要聞" />
<meta property="og:description" content="出品 | AI科技大本營（ID：rgznai100） 【導語】Angel 是騰訊的首個AI開源項目，於 2016 年底推出、2017年開源。近日，快速發展的 Angel 完成了從 2.0 版本到 3.0 版本的跨越，從一個單純的模型訓練系統進化成包含從自動特徵工程到模型服務的全棧機器學習平台。作為面向機器學習的第三代高性能計算平台，Ang……" />
<meta property="og:url" content="https://daynews.cc/technology/26515/" />
<meta property="og:site_name" content="天天要聞" />
<meta property="article:section" content="科技" />
<meta property="article:published_time" content="2019-12-22T05:15:12+00:00" />
	<title>騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目 - 天天要聞</title>
		<link rel="canonical" href="https://daynews.cc/technology/26515/" />
	<script type='text/javascript' src='https://cdn.ampproject.org/v0.js' async></script>
<script type='text/javascript' src='https://cdn.ampproject.org/v0/amp-analytics-0.1.js' async custom-element="amp-analytics"></script>
<style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><meta name="generator" content="AMP Plugin v1.4.1; mode=reader; experiences=website"><meta name="generator" content="WordPress 5.2.4" />
	<style amp-custom>
		/* Generic WP styling */

.alignright {
	float: right;
}

.alignleft {
	float: left;
}

.aligncenter {
	display: block;
	text-align: center;
	margin-left: auto;
	margin-right: auto;
}

.amp-wp-enforced-sizes {
	/** Our sizes fallback is 100vw, and we have a padding on the container; the max-width here prevents the element from overflowing. **/
	max-width: 100%;
	margin: 0 auto;
}


/*
 * Prevent cases of amp-img converted from img to appear with stretching by using object-fit to scale.
 * See <https://github.com/ampproject/amphtml/issues/21371#issuecomment-475443219>.
 * Also use object-fit:contain in worst case scenario when we can't figure out dimensions for an image.
 * Additionally, in side of \AMP_Img_Sanitizer::determine_dimensions() it could $amp_img->setAttribute( 'object-fit', 'contain' )
 * so that the following rules wouldn't be needed.
 */
amp-img.amp-wp-enforced-sizes[layout="intrinsic"] > img,
amp-anim.amp-wp-enforced-sizes[layout="intrinsic"] > img {
	object-fit: contain;
}

amp-fit-text blockquote,
amp-fit-text h1,
amp-fit-text h2,
amp-fit-text h3,
amp-fit-text h4,
amp-fit-text h5,
amp-fit-text h6 {
	font-size: inherit;
}

/**
 * Override a style rule in Twenty Sixteen and Twenty Seventeen.
 * It set display:none for audio elements.
 * This selector is the same, though it adds body and uses amp-audio instead of audio.
 */
body amp-audio:not([controls]) {
	display: inline-block;
	height: auto;
}

/*
 * Style the default template messages for submit-success, submit-error, and submitting. These elements are inserted
 * by the form sanitizer when a POST form lacks the action-xhr attribute.
 */
.amp-wp-default-form-message > p {
	margin: 1em 0;
	padding: 0.5em;
}

.amp-wp-default-form-message[submitting] > p,
.amp-wp-default-form-message[submit-success] > p.amp-wp-form-redirecting {
	font-style: italic;
}

.amp-wp-default-form-message[submit-success] > p:not(.amp-wp-form-redirecting) {
	border: solid 1px #008000;
	background-color: #90ee90;
	color: #000;
}

.amp-wp-default-form-message[submit-error] > p {
	border: solid 1px #f00;
	background-color: #ffb6c1;
	color: #000;
}

/* Prevent showing empty success message in the case of an AMP-Redirect-To response header. */
.amp-wp-default-form-message[submit-success] > p:empty {
	display: none;
}

amp-carousel .amp-wp-gallery-caption {
	position: absolute;
	bottom: 0;
	left: 0;
	right: 0;
	text-align: center;
	background-color: rgba(0, 0, 0, 0.5);
	color: #fff;
	padding: 1rem;
}

.wp-block-gallery[data-amp-carousel="true"] {
	display: block;
	flex-wrap: unset;
}

/* Template Styles */

.amp-wp-content,
.amp-wp-title-bar div {
		margin: 0 auto;
	max-width: 600px;
	}

html {
	background: #0a89c0;
}

body {
	background: #fff;
	color: #353535;
	font-family: Georgia, 'Times New Roman', Times, Serif;
	font-weight: 300;
	line-height: 1.75em;
}

p,
ol,
ul,
figure {
	margin: 0 0 1em;
	padding: 0;
}

a,
a:visited {
	color: #0a89c0;
}

a:hover,
a:active,
a:focus {
	color: #353535;
}

/* Quotes */

blockquote {
	color: #353535;
	background: rgba(127,127,127,.125);
	border-left: 2px solid #0a89c0;
	margin: 8px 0 24px 0;
	padding: 16px;
}

blockquote p:last-child {
	margin-bottom: 0;
}

/* UI Fonts */

.amp-wp-meta,
.amp-wp-header div,
.amp-wp-title,
.wp-caption-text,
.amp-wp-tax-category,
.amp-wp-tax-tag,
.amp-wp-comments-link,
.amp-wp-footer p,
.back-to-top {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen-Sans", "Ubuntu", "Cantarell", "Helvetica Neue", sans-serif;
}

/* Header */

.amp-wp-header {
	background-color: #0a89c0;
}

.amp-wp-header div {
	color: #fff;
	font-size: 1em;
	font-weight: 400;
	margin: 0 auto;
	max-width: calc(840px - 32px);
	padding: .875em 16px;
	position: relative;
}

.amp-wp-header a {
	color: #fff;
	text-decoration: none;
}

	.amp-wp-header .amp-wp-canonical-link {
		font-size: 0.8em;
		text-decoration: underline;
		position: absolute;
		right: 18px;	}

.amp-wp-header .amp-wp-site-icon {
	/** site icon is 32px **/
	background-color: #fff;
	border: 1px solid #fff;
	border-radius: 50%;
	position: absolute;
	right: 18px;
	top: 10px;
}

/* Article */

.amp-wp-article {
	color: #353535;
	font-weight: 400;
	margin: 1.5em auto;
	max-width: 840px;
	overflow-wrap: break-word;
	word-wrap: break-word;
}

/* Article Header */

.amp-wp-article-header {
	align-items: center;
	align-content: stretch;
	display: flex;
	flex-wrap: wrap;
	justify-content: space-between;
	margin: 1.5em 16px 0;
}

.amp-wp-title {
	color: #353535;
	display: block;
	flex: 1 0 100%;
	font-weight: 900;
	margin: 0 0 .625em;
	width: 100%;
}

/* Article Meta */

.amp-wp-meta {
	color: #696969;
	display: inline-block;
	flex: 2 1 50%;
	font-size: .875em;
	line-height: 1.5em;
	margin: 0 0 1.5em;
	padding: 0;
}

.amp-wp-article-header .amp-wp-meta:last-of-type {
	text-align: right;
}

.amp-wp-article-header .amp-wp-meta:first-of-type {
	text-align: left;
}

.amp-wp-byline amp-img,
.amp-wp-byline .amp-wp-author {
	display: inline-block;
	vertical-align: middle;
}

.amp-wp-byline amp-img {
	border: 1px solid #0a89c0;
	border-radius: 50%;
	position: relative;
	margin-right: 6px;
}

.amp-wp-posted-on {
	text-align: right;
}

/* Featured image */

.amp-wp-article-featured-image {
	margin: 0 0 1em;
}
.amp-wp-article-featured-image amp-img {
	margin: 0 auto;
}
.amp-wp-article-featured-image.wp-caption .wp-caption-text {
	margin: 0 18px;
}

/* Article Content */

.amp-wp-article-content {
	margin: 0 16px;
}

.amp-wp-article-content ul,
.amp-wp-article-content ol {
	margin-left: 1em;
}

.amp-wp-article-content .wp-caption {
	max-width: 100%;
}

.amp-wp-article-content amp-img {
	margin: 0 auto;
}

.amp-wp-article-content amp-img.alignright {
	margin: 0 0 1em 16px;
}

.amp-wp-article-content amp-img.alignleft {
	margin: 0 16px 1em 0;
}

/* Captions */

.wp-caption {
	padding: 0;
}

.wp-caption.alignleft {
	margin-right: 16px;
}

.wp-caption.alignright {
	margin-left: 16px;
}

.wp-caption .wp-caption-text {
	border-bottom: 1px solid #c2c2c2;
	color: #696969;
	font-size: .875em;
	line-height: 1.5em;
	margin: 0;
	padding: .66em 10px .75em;
}

/* AMP Media */

.alignwide,
.alignfull {
	clear: both;
}

amp-carousel {
	background: #c2c2c2;
	margin: 0 -16px 1.5em;
}
amp-iframe,
amp-youtube,
amp-instagram,
amp-vine {
	background: #c2c2c2;
	margin: 0 -16px 1.5em;
}

.amp-wp-article-content amp-carousel amp-img {
	border: none;
}

amp-carousel > amp-img > img {
	object-fit: contain;
}

.amp-wp-iframe-placeholder {
	background: #c2c2c2 url( https://daynews.cc/wp-content/plugins/amp/assets/images/placeholder-icon.png ) no-repeat center 40%;
	background-size: 48px 48px;
	min-height: 48px;
}

/* Article Footer Meta */

.amp-wp-article-footer .amp-wp-meta {
	display: block;
}

.amp-wp-tax-category,
.amp-wp-tax-tag {
	color: #696969;
	font-size: .875em;
	line-height: 1.5em;
	margin: 1.5em 16px;
}

.amp-wp-comments-link {
	color: #696969;
	font-size: .875em;
	line-height: 1.5em;
	text-align: center;
	margin: 2.25em 0 1.5em;
}

.amp-wp-comments-link a {
	border-style: solid;
	border-color: #c2c2c2;
	border-width: 1px 1px 2px;
	border-radius: 4px;
	background-color: transparent;
	color: #0a89c0;
	cursor: pointer;
	display: block;
	font-size: 14px;
	font-weight: 600;
	line-height: 18px;
	margin: 0 auto;
	max-width: 200px;
	padding: 11px 16px;
	text-decoration: none;
	width: 50%;
	-webkit-transition: background-color 0.2s ease;
			transition: background-color 0.2s ease;
}

/* AMP Footer */

.amp-wp-footer {
	border-top: 1px solid #c2c2c2;
	margin: calc(1.5em - 1px) 0 0;
}

.amp-wp-footer div {
	margin: 0 auto;
	max-width: calc(840px - 32px);
	padding: 1.25em 16px 1.25em;
	position: relative;
}

.amp-wp-footer h2 {
	font-size: 1em;
	line-height: 1.375em;
	margin: 0 0 .5em;
}

.amp-wp-footer p {
	color: #696969;
	font-size: .8em;
	line-height: 1.5em;
	margin: 0 85px 0 0;
}

.amp-wp-footer a {
	text-decoration: none;
}

.back-to-top {
	bottom: 1.275em;
	font-size: .8em;
	font-weight: 600;
	line-height: 2em;
	position: absolute;
	right: 16px;
}
		td, th {
	text-align: left;
}

a, a:active, a:visited {
	text-decoration: underline;
}

	</style>
	
</head>

<body class="">


<header id="top" class="amp-wp-header">
	<div>
		<a href="https://daynews.cc/">
									<span class="amp-site-title">
				天天要聞			</span>
		</a>

										<a class="amp-wp-canonical-link" href="https://daynews.cc/technology/26515/">
				原網頁			</a>
			</div>
</header>

<article class="amp-wp-article">
	<header class="amp-wp-article-header">
		<h1 class="amp-wp-title">騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目</h1>
			<div class="amp-wp-meta amp-wp-byline">
					<amp-img src="https://daynews.cc/wp-content/themes/Kratos/images/default_avatar.jpeg" alt="天天要聞" width="24" height="24" layout="fixed"></amp-img>
				<span class="amp-wp-author author vcard">天天要聞</span>
	</div>
<div class="amp-wp-meta amp-wp-posted-on">
	<time datetime="2019-12-22T13:15:12+00:00">
		2019-12-22	</time>
</div>
	</header>

	
	<div class="amp-wp-article-content">
		
		<div>
<p>出品 | AI科技大本營（<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">ID：</i>rgznai100）</p>
<p>【導語】Angel 是騰訊的首個AI開源項目，於 2016 年底推出、2017年開源。近日，快速發展的 Angel 完成了從 2.0 版本到 3.0 版本的跨越，從一個單純的模型訓練系統進化成包含從自動特徵工程到模型服務的全棧機器學習平台。作為面向機器學習的第三代高性能計算平台，Angel 致力於解決稀疏數據大模型訓練以及大規模圖數據分析問題。</p>
<p>近日，Linux基金會旗下面向AI領域的頂級基金會——LF AI基金會（Linux Foundation Artificial Intelligence Foundation）正式宣布，騰訊開源項目 Angel 從LF AI基金會畢業，是中國首個從LF AI基金會畢業的開源項目。接下來，我們就從 Angel 3.0 的系統架構出發，從 Angel 在開源方面取得的成績、新加入的圖機器學習功能等新特性、使用情況及 Angel 的落地案例等方面，對 Angel 全方位的學習與了解。</p>

<h2>概述</h2>
<p>Angel是騰訊開源的大規模分散式機器學習平台，專註於稀疏數據高維模型的訓練。目前Angel是Linux深度學習基金會孵化項目，相比於TensorFlow, PyTorch和Spark等業界同類平台，她有如下特點：</p>
<ul>
<li>
<p>Angel是一個基於Parameter Server（PS）理念開發的高性能分散式機器學習平台，它具有靈活的可定製函數PS Function（PSF），可以將部分計算下推至PS端。PS架構良好的橫向擴展能力讓Angel能高效處理千億級別的模型。</p>
</li>
<li>
<p>Angel具有專門為處理高維稀疏特徵特別優化的數學庫，性能可達breeze數學庫的10倍以上。Angel的PS和內置的演算法內核均構建在該數學庫之上。</p>
</li>
<li>
<p>Angel擅長推薦模型和圖網路模型相關領域（如社交網路分析）。圖1是Angel和幾個業界主流平台在稀疏數據，模型維度，性能表現，深度模型和生態建設幾個維度的對比。Tensorflow和PyTouch在深度學習領域和生態建設方面優勢明顯，但在稀疏數據和高維模型方面的處理能力相對不足，而Angel正好與它們形成互補，3.0版本推出的PyTorch On Angel嘗試將PyTorch和Angel的優勢<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-3">結合</i>在一起。</p>
</li>
</ul>
<p> <amp-img src="http://p3.pstatp.com/large/pgc-image/Ra368aR1KcTeVl" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p3.pstatp.com/large/pgc-image/Ra368aR1KcTeVl" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖 1 Angel與業界主流平台的對比</p>

<h2>一、Angel系統架構</h2>
<p>Angel 3.0系統架構如圖2所示。</p>
<p> <amp-img src="http://p3.pstatp.com/large/pgc-image/Ra9O7vf6sBpMWG" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p3.pstatp.com/large/pgc-image/Ra9O7vf6sBpMWG" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖 2 Angel 3.0架構</p>
<p>Angel 自研的高性能數學庫是整個系統的基礎，Angel的PS功能和內置的演算法內核均是在這個數學庫基礎之上實現的。</p>
<p>Angel PS提供了高效，穩定和靈活的參數存儲和交換服務。在3.0版本中，我們對Angel PS功能進行了擴展，使得它可以存儲任意類型的對象，一個典型的例子是在圖演算法的實現過程中，我們使用Angel PS來存儲了大量複雜的對象。</p>
<p>MLcore是Angel自研的一套演算法內核，它支持自動求導，可以使用JSON配置文件定義和運行演算法。除此之外，在3.0版本中，Angel還集成了PyTorch作為計算引擎。在計算引擎層之上是計算框架，它們可以看作計算引擎的容器，目前支持3種計算框架：原生的Angel，Spark On Angel（SONA）和PyTorch On Angel（PyTONA），這些計算框架可以使得Spark和PyTorch用戶可以無縫切換到Angel平台。最上層是兩個公共組件：AutoML和模型服務。</p>

<h2>二、Angel開源</h2>
<p>2018年，騰訊受邀作為Linux基金會旗下面向AI領域的頂級基金會——LF AI基金會（Linux Foundation Artificial Intelligence Foundation）的初始白金會員加入，擁有董事會和技術諮詢委員會席位，並於同年向基金會捐贈高性能分散式機器學習平台Angel。</p>
<p>北京時間12月20日，LF AI基金會正式宣布，騰訊開源項目Angel從LF AI基金會畢業，也是中國首個從LF AI基金會畢業的開源項目。這意味著，Angel得到全球技術專家的認可，成為世界最頂級的AI開源項目之一。</p>
<p>LF AI基金會執行總監Ibrahim Ha<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-5">dd</i>ad表示：「在Angel從孵化到畢業的過程中，我們能看到Angel在新功能完善和應用場景落地方面驚人的速度。隨著3.0版本的發布，Angel在功能、適用性和對社區的貢獻等都有了非常優秀的表現。這也是整個AI開源社區在走向成熟並具備工業級生產能力的方向上邁出了一大步。」</p>
<p>騰訊雲副總裁、騰訊數據平台部總經理蔣傑表示：「騰訊致力於通過開源代碼，與開發者共建開源生態、實現成果共享，已成為大數據領域開源最為全面的公司。我們很高興看到Angel從LF AI基金會成功畢業，在基金會的指導和開發者的共建下，完成從單一的模型訓練平台到全棧機器學習平台的技術跨越，這也與騰訊大數據批流融合、ABC融合的未來發展方向緊密契合。畢業是Angel新的開始，未來我們將進一步開放Angel在圖計算和聯邦學習領域的核心能力。」</p>
<p>據LF AI 基金會董事、騰訊AI專家肖涵介紹，LF AI基金會對開源項目的畢業流程有非常嚴格的規定，基於項目的技術含量、開源生態、社區互動等維度，嚴格評估項目的成熟度，最終由董事會投票決定能否准予畢業。能夠從LF AI畢業，意味著項目已經得到全球技術專家的認可，成為最頂級的AI開源項目。</p>
<p>開源協同是當前騰訊最重要的技術戰略之一。在今年的重慶智博會上，騰訊公司董事會<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-3">主席</i>兼首席執行官馬化騰專門提及了對開源的重視，他表示，騰訊希望在科研領域投入更多力量，將通過內外部開源等方式，積极參与「全球科技共同體」的共建。</p>
<p>截止2019年11月，僅在Github上，騰訊就開源了91個項目，有超過1000個貢獻者參與，獲得超過26萬個Star數，在Github全球公司貢獻榜上居於前列。騰訊還加入了Linux、Apache等9大開源基金會，並成為最高級別會員。其中LF AI基金會是由Linux基金會發起的人工智慧領域的專項開源基金會，旨在倡導和組織AI開源平台和工具共同參與建設，共同享有IP知識產權，創建可持續發展的開源AI生態系統。</p>
<p> <amp-img src="http://p3.pstatp.com/large/pgc-image/Ra368naIaagVNC" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p3.pstatp.com/large/pgc-image/Ra368naIaagVNC" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖 3 GitHub上Angel的統計信息以及Angel發表的論文</p>

<h2>三、Angel 3.0新特性</h2>
<p>從1.0到3.0，Angel發生了巨大的變化，它從一個單一的模型訓練平台發展到涵蓋機器學習各個流程，包含自己生態的通用計算平台，代碼量也超過了50萬行。為了後續維護和使用的方便，Angel拆分成8個子項目，統一放在Angel-ML目錄下：angel，PyTorch On Angel，sona，serving，automl，mlcore，math2和format，這些子項目會在下文詳細介紹。</p>
<p> <amp-img src="http://p3.pstatp.com/large/pgc-image/Ra368npGJW4dKI" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p3.pstatp.com/large/pgc-image/Ra368npGJW4dKI" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖 4 Angel 3.0概覽（紅色的表示新增特性，白色的表示已有的但在持續改進的特性）</p>
<p>圖4提供了一個Angel 3.0特性的整體視圖。Angel 3.0試圖打造一個全棧的機器學習平台，它的功能特性涵蓋了機器學習的各個階段：特徵工程，模型訓練，超參數調節和模型服務。</p>
<p>Angel的特徵工程模塊基於Spark開發，增強了Spark的特徵選擇功能，同時使用特徵交叉和重索引實現了自動特徵生成。這些組件可以無縫地整合進Spark的流水線。為了讓整個系統更加的智能，Angel 3.0新增了超參數調節的功能，目前支持3種演算法：隨機<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">搜索</i>，網格<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">搜索</i>和貝葉斯優化。在模型服務方面，Angel 3.0提供了一個跨平台的組件Angel Serving， Angel Serving不僅可以滿足Angel自身的需求，還可以為其他平台提供模型服務。</p>
<p>在生態方面，Angel也嘗試將PS能力賦能給其他的計算平台，目前已經完成了Spark On Angel和PyTorch On Angel兩個平台的建設。這兩個平台各有優勢和側重， Spark On Angel使用的是Angel內置的演算法核心，主要負責常見推薦領域的機器學習演算法和基礎圖演算法。PyToch On Angel使用PyTorch作為計算核心，主要負責推薦領域深度學習演算法和圖深度學習演算法。</p>
<h2></h2>
<p><strong class="highlight-text">1、自動特徵工程</strong></p>
<p>特徵工程，例如特徵交叉和選擇，對於工業界的機器學習應用具有重要意義。Spark提供了一些特徵選擇運算元，但是仍有一些局限性。Angel基於Spark提供了更多的特徵選擇運算元：</p>
<ul>
<li>
<p>基於統計的運算符，包括VarianceSelector和FtestSelector</p>
</li>
<li>
<p>基於模型的運算符，包括LassoSelector和RandomForestSelector</p>
</li>
</ul>
<p>大多數在線推薦系統經常選擇線性演算法，例如邏輯回歸作為機器學習模型，但邏輯回歸需要複雜的特徵工程才能實現較高的精度，這使得自動特徵合成至關重要。但是，現有的自動化的高階特徵合成方法帶來了維度災難。為了解決這個問題，Angel實現了一種迭代生成高階合成特徵的方法。每次迭代由兩個階段組成：</p>
<ul>
<li>
<p>擴增階段：任意特徵的笛卡爾積</p>
</li>
<li>
<p>縮約階段：特徵選擇和特徵重索引</p>
</li>
</ul>
<p>以下是迭代步驟：</p>
<ul>
<li>
<p>首先任意的輸入特徵之間通過笛卡爾積生成合成特徵。該步驟後，特徵數量將以二次方式增加</p>
</li>
<li>
<p>接下來，從合成特徵中選擇最重要的特徵子集（使用例如VarianceSelector和RandomForestSelector）</p>
</li>
<li>
<p>然後，重新索引所選擇的特徵以減少特徵空間</p>
</li>
<li>
<p>最後，合成特徵與原始特徵拼接在一起</p>
</li>
</ul>
<p> <amp-img src="http://p1.pstatp.com/large/pgc-image/Ra368o2CsC5LAK" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p1.pstatp.com/large/pgc-image/Ra368o2CsC5LAK" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖 5 自動特徵工程流程</p>
<p>如圖5所示，這種特徵合成方法線性地增加特徵數量，避免了維度災難。在Higgs數據集上的實驗表明合成的特徵能有效地提高模型精度（如表1所示）。</p>

<table>
<tbody>
<tr>
<td>
<div>
<p>LR</p>

</div>
</td>
<td>
<div>
<p>FM</p>

</div>
</td>
<td>
<div>
<p>Ours</p>

</div>
</td>
</tr>
<tr>
<td>
<div>
<p>AUC</p>

</div>
</td>
<td>
<div>
<p>0.68</p>

</div>
</td>
<td>
<div>
<p>0.69</p>

</div>
</td>
<td>
<div>
<p>0.70</p>

</div>
</td>
</tr>
</tbody>
</table>
<p>表 1 特徵合成效果</p>
<h2></h2>
<p><strong class="highlight-text">2、Spark On Angel (SONA)</strong></p>
<p>在Angel 3.0中，我們對Spark On Angel做了大幅度的優化，添加了下面這些新的特性：</p>
<ul>
<li>
<p>Spark On Angel中集成了特徵工程。在集成的過程中並不是簡單地借用Spark的特徵工程，我們為所有的運算支持了長整型索引的向量使其能夠訓練高維稀疏模型</p>
</li>
<li>
<p>與自動調參無縫連接</p>
</li>
<li>
<p>Spark用戶能夠通過Spark-fashion API毫不費力的將Spark轉換成Angel</p>
</li>
<li>
<p>支持兩種新的數據格式：LibFFM 和Dummy</p>
</li>
</ul>
<p> <amp-img src="http://p3.pstatp.com/large/pgc-image/Ra9O7vyAs5LGLs" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p3.pstatp.com/large/pgc-image/Ra9O7vyAs5LGLs" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖 6 Spark On Angel架構</p>
<p>除了這些大的特徵，我們也在持續完善Spark On Angel的演算法庫：添加了一些新的演算法，如：Deep &amp; Cross Network (DCN) 和 Attention Factorization Machines (AFM)等；同時對已有的演算法做了大量的優化，例如對LINE和K-Core演算法進行了重構，重構後的演算法性能和穩定性都有大幅度提升。</p>
<p>從圖7中可以看出，Spark On Angel中的演算法與Spark中的演算法存在顯著的不同，如：基於Spark On Angel的演算法主要是針對推薦和圖領域，然而Spark中的演算法更通用。</p>
<p> <amp-img src="http://p1.pstatp.com/large/pgc-image/Ra9O85BHtGcGCu" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p1.pstatp.com/large/pgc-image/Ra9O85BHtGcGCu" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖 7 Spark與Spark On Angel演算法比較</p>
<p> <amp-img src="http://p3.pstatp.com/large/pgc-image/Ra9O85Q7cwESn7" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p3.pstatp.com/large/pgc-image/Ra9O85Q7cwESn7" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖 8 Spark On Angel演算法示例</p>
<p>圖8提供了一個基於Spark On Angel的分散式演算法示例，主要包含以下步驟：</p>
<ul>
<li>
<p>在程序開始時啟動參數伺服器，程序結束時關閉參數伺服器</p>
</li>
<li>
<p>將訓練集和測試集以Spark DataFrame形式載入</p>
</li>
<li>
<p>定義一個Angel模型並以Spark的參數設置方式為其設置參數。在這個示例中，演算法是一個通過JSON定義的計算圖</p>
</li>
<li>
<p>使用「fit」方法來訓練模型</p>
</li>
<li>
<p>使用「evaluate」方法來評估已訓練的模型</p>
</li>
</ul>
<p>在訓練完成後，Spark On Angel將會展示多種模型指標，如：準確率, ROC 曲線, AUC等。用戶可以保存訓練好的模型以便下次使用。</p>
<p> <amp-img src="http://p1.pstatp.com/large/pgc-image/Ra9O85jIbepHRV" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p1.pstatp.com/large/pgc-image/Ra9O85jIbepHRV" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖 9 Spark On Angel和TensorFlow性能比較</p>
<p>我們在兩種流行的推薦演算法Deep &amp; Wide 和 DeepFM上使用了相同的資源和數據集比較了Spark On Angel和Tensorflow的性能。如圖11所示，在Deep &amp; Wide演算法上Spark On Angel比Tensorflow快3倍，而在DeepFM演算法上Tensorflow運行稍快一些。</p>
<h2></h2>
<p><strong class="highlight-text">3、PyTorch On Angel（PyTONA）</strong></p>
<p>PyTorch On Angel是Angel 3.0新增的特性，它主要是為了解決大規模圖表示學習和深度學習模型訓練問題。</p>
<p>在過去幾年時間，圖卷積神經網路（GNN）快速發展，一系列的研究論文以及相關的演算法問世：例如GCN，GraphSAGE和GAT等，研究和測試結果表明，它們能夠比傳統圖表示學習更好的抽取圖特徵。騰訊擁有龐大的社交網路（<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">QQ</i>和<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">微信</i>），同時擁有大量對圖數據進行分析的需求，而圖表示學習正是這些分析的基礎，因此騰訊內部對GNN有著強烈的需求，這也是我們開發PyTorch On Angel的主要原因之一。</p>
<p>大規模圖的表示學習面臨著兩個主要的挑戰：第一個挑戰來自於超大規模圖結構的存儲以及訪問，這要求系統不僅能存得下，還需要提供高效的訪問介面，例如需要提供高效的訪問任意節點的兩跳鄰居的介面；第二個挑戰來自於GNN計算過程，它需要有高效的自動求導模塊。</p>
<p>通過對Angel自身狀況以及對業界已有系統的分析，我們得到如下結論：</p>
<ul>
<li>
<p>TensorFlow和PyTorch擁有高效的自動求導模塊，但是它們不擅長處理高維度模型和稀疏數據</p>
</li>
<li>
<p>Angel擅長處理高維度模型和稀疏數據，雖然Angel自研的計算圖框架（MLcore）也可以自動求導，但是在效率和功能完整性上卻不及TensorFlow和PyTorch，無法滿足GNN的要求</p>
</li>
</ul>
<p>為了將兩者的優勢<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-3">結合</i>起來，我們基於Angel PS開發了PyTorch On Angel平台，基本思路是使用Angel PS來存儲大模型，使用Spark來作為PyTorch的分散式調度平台，也就是在在Spark的Executor中調用PyTorch來完成計算。</p>
<p>PyTorch On Angel的架構如圖10所示： </p>
<p> <amp-img src="http://p1.pstatp.com/large/pgc-image/Ra3694JGXGG62l" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p1.pstatp.com/large/pgc-image/Ra3694JGXGG62l" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖 10 PyTorch On Angel系統架構</p>
<p>PyTorch On Angel擁有3個主要的組件：</p>
<ul>
<li>
<p>Angel PS：存儲模型參數，圖結構信息和節點特徵等，並且提供模型參數和圖相關數據結構的訪問介面，例如需要提供兩跳鄰接訪問介面</p>
</li>
<li>
<p>Spark Driver：中央控制節點，負責計算任務的調度和一些全局的控制功能，例如發起創建矩陣，初始化模型，保存模型，寫checkpoint以及恢復模型命令</p>
</li>
<li>
<p>Spark Worker：讀取計算數據，同時從PS上拉取模型參數和網路結構等信息，然後將這些訓練數據參數和網路結構傳給PyTorch，PyTorch負責具體的計算並且返回梯度，最後Spark Worker將梯度推送到PS更新模型</p>
</li>
</ul>
<p>當然，這些細節都是封裝好的，演算法開發人員和用戶並不需要了解。在PyTorch On Angel平台上開發新演算法，只需要<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-6">關注</i>演算法邏輯即可，與開發單機的PyTorch演算法並沒有太大區別。下面給出一個2層GCN演算法的實現例子：</p>
<p> <amp-img src="http://p1.pstatp.com/large/pgc-image/Ra369ImHqSvkZA" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p1.pstatp.com/large/pgc-image/Ra369ImHqSvkZA" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖 11 在PyTorch On Angel上實現GCN的例子</p>
<p>演算法開發完成後，將代碼保存為pt文件，然後將pt文件提交給PyTorch On Angel平台就可以實現分散式訓練了。</p>
<p>我們已經在PyTorch On Angel上實現了許多演算法：包括推薦領域常見的演算法（FM，DeepFM，Wide &amp; Deep，xDeepFM，AttentionFM， DCN和PNN等）和GNN演算法（GCN和GraphSAGE）。在後續的版本迭代中，我們將會進一步豐富PyTorch On Angel的演算法庫。</p>
<p>由於<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-3">結合</i>了PyTorch和Angel的優點，PyTorch On Angel在演算法性能方面有很大的優勢：對於推薦領域常見的深度學習演算法，性能可以達到TensorFlow的4倍以上；對於GNN演算法，性能也遠好於目前業界開源的同類型平台（具體的性能數據會在開源社區陸續公開）。下圖是在公開的數據集criteo kaggle2014(4500萬訓練樣本，100w特徵)上做的對比測試：</p>
<p> <amp-img src="http://p1.pstatp.com/large/pgc-image/Ra9O8GPJpKOlB" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p1.pstatp.com/large/pgc-image/Ra9O8GPJpKOlB" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖 12 PyTorch On Angel和TensorFlow性能對比測試</p>
<p>除了性能方面的優勢，PyTorch On Angel還有一個比較大的優勢就是易用性好。如圖12所示：PyTorch運行在Spark的Executor中，可以實現Spark圖數據預處理和PyTorch模型訓練的無縫對接，在一個程序中完成整個計算過程。</p>

<h2>4、自動超參數調節</h2>
<p>傳統超參數調節的方式有兩種（如圖15所示）：</p>
<ul>
<li>
<p>網格<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">搜索</i>：網格<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">搜索</i>將整個<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">搜索</i>空間切分為網格，假設超參數是同等重要的。這種方式雖然直觀，但有兩個明顯的缺點：1）計算代價隨參數數量的增長而呈指數增長；2）超參數的重要程度常常是不同的，網格<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">搜索</i>可能會花費太多精力來優化不太重要的超參數</p>
</li>
<li>
<p>隨機<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">搜索</i>：隨機採樣超參數組合，並評估抽樣組合。雖然這種方法有可能<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-6">關注</i>更重要的超參數，但是仍無法保證找到最佳組合</p>
</li>
</ul>
<p> <amp-img src="http://p1.pstatp.com/large/pgc-image/Ra369JKEuLoEif" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p1.pstatp.com/large/pgc-image/Ra369JKEuLoEif" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖 13 網格<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">搜索</i>和隨機<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">搜索</i></p>
<p>貝葉斯優化與傳統的無模型方法不同，使用計算成本較低的代理函數（surrogate function）來近似原始目標函數。在貝葉斯優化中，代理函數生成超參數組合的概率均值和方差。然後，效用函數（acquisition function）將評估超參數組合的預期損失或改進。這樣的概率解釋方法使貝葉斯優化能夠使用少得多的開銷找到目標函數的較優解。</p>
<p>Angel 3.0包括傳統的兩種方法和貝葉斯演算法優化。對貝葉斯優化，Angel實現了以下的功能：</p>
<ul>
<li>
<p>代理函數。除了常用的兩種模型（高斯過程和隨機森林），也實現了EM + LBFGS優化高斯過程內核函數中的超參數</p>
</li>
<li>
<p>效用函數：實現了PI（Probability of improvement），EI（Expected Improvement）和UCB（Upper Confidence Bound）</p>
</li>
</ul>
<p>由於每次評估目標函數的計算開銷可能較大，如果觀察到候選的超參數組合在開始的若干輪迭代中表現不佳，可以提前停止這些候選超參數組合。Angel 3.0版本中實現了這種早停策略。</p>
<p>表2是在邏輯回歸演算法的實驗，調節的超參數是學習速度和學習速度衰減率，結果顯示貝葉斯優化的性能優於隨機<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">搜索</i>和網格<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">搜索</i>，而隨機<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">搜索</i>的結果略優於網格<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">搜索</i></p>

<table>
<tbody>
<tr>
<td>
<div>
<p>Random</p>

</div>
</td>
<td>
<div>
<p>Grid</p>

</div>
</td>
<td>
<div>
<p>GP</p>

</div>
</td>
</tr>
<tr>
<td>
<div>
<p>AUC</p>

</div>
</td>
<td>
<div>
<p>0.926</p>

</div>
</td>
<td>
<div>
<p>0.924</p>

</div>
</td>
<td>
<div>
<p>0.933</p>

</div>
</td>
</tr>
</tbody>
</table>
<p>表 2 不同超參數自動條件方法的效果對比</p>

<h2>5、Angel Serving</h2>
<p>為了滿足在生產環境中高效地進行模型服務的需求，我們在Angel 3.0中實現了Angel Serving子系統，它是一個可拓展性強、高性能的機器學習模型服務系統，是全棧式機器學習平台Angel的上層服務入口，使Angel生態能夠形成閉環。圖16展示了Angel Serving的架構設計。</p>
<p> <amp-img src="http://p1.pstatp.com/large/pgc-image/Ra9O8Gu9NedNE8" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p1.pstatp.com/large/pgc-image/Ra9O8Gu9NedNE8" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖 14 Angel Serving架構</p>
<p>Angel Serving主要特徵包括：1）支持多種類型的API訪問服務，包括gRPC和Restful 介面；2）Angel Serving是一個通用的機器學習服務框架，可插拔機制設計使得來自其他第三方機器學習平台的模型可以很容易使用Angel Serving來服務，目前已經支持三種平台的模型：Angel，PyTorch和支持PMML模型格式的平台（Spark、XGBoost等）；3）受TensorFlow Serving的啟發，Angel Serving還提供細粒度版本控制策略：包括使用模型的最早，最新以及指定版本進行服務；4）Angel Serving還提供豐富的的模型服務監控指標，包括：</p>
<ul>
<li>
<p>QPS: 每秒請求數</p>
</li>
<li>
<p>總的請求數以及成功請求總數</p>
</li>
<li>
<p>請求的響應時間分布</p>
</li>
<li>
<p>平均響應時間</p>
</li>
</ul>
<table>
<tbody>
<tr>
<td>
<div>
<p>Angel Serving</p>

</div>
</td>
<td>
<div>
<p>TensorFlow Serving</p>

</div>
</td>
</tr>
<tr>
<td>
<div>
<p>總耗時(s)</p>

</div>
</td>
<td>
<div>
<p>56</p>

</div>
</td>
<td>
<div>
<p>59</p>

</div>
</td>
</tr>
<tr>
<td>
<div>
<p>最小響應時間(ms)</p>

</div>
</td>
<td>
<div>
<p>1</p>

</div>
</td>
<td>
<div>
<p>1</p>

</div>
</td>
</tr>
<tr>
<td>
<div>
<p>平均響應時間(ms)</p>

</div>
</td>
<td>
<div>
<p>2</p>

</div>
</td>
<td>
<div>
<p>2</p>

</div>
</td>
</tr>
<tr>
<td>
<div>
<p>99% 分位響應時間(ms)</p>

</div>
</td>
<td>
<div>
<p>2</p>

</div>
</td>
<td>
<div>
<p>3</p>

</div>
</td>
</tr>
<tr>
<td>
<div>
<p>QPS</p>

</div>
</td>
<td>
<div>
<p>1900</p>

</div>
</td>
<td>
<div>
<p>1800</p>

</div>
</td>
</tr>
</tbody>
</table>
<p>表 3 Angel Serving和Tensorflow Serving性能對比</p>
<p>表3展示了Angel Serving和TensorFlow Serving性能對比結果，我們使用具有100萬個特徵的DeepFM模型，向服務發送100,000個預測請求。Angel Serving和TensorFlow Serving的總耗時分別為56秒和59秒。兩個服務系統的平均響應時間都為2毫秒。Angel Serving的QPS是1,900，而TensorFlow Serving的QPS是1,800。上述結果表明Angel Serving與TensorFlow Serving性能相當，甚至更好。</p>
<p>Angel Serving 不僅可以滿足Angel自身的需求，還可以為其他平台提供模型服務。在生態方面，Angel也嘗試將參數伺服器（PS）能力共享給其他的計算平台，目前已經完成了Spark On Angel和PyTorch On Angel兩個平台的建設。</p>
<p> <amp-img src="http://p1.pstatp.com/large/pgc-image/RlIbOjd65SsOYO" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p1.pstatp.com/large/pgc-image/RlIbOjd65SsOYO" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖15 圖計算體系架構</p>
<p>在3.0版本中，Angel重點研發了圖機器學習功能，包括圖表示和圖神經網路學習模型，同時提供預處理、圖挖掘等端到端數據處理能力，具有豐富的演算法庫，提供了同構圖、異構圖多種圖計算範式和不同種類的圖演算法。經過騰訊內部業務的大規模實踐，Angel在圖演算法性能上同樣表現出眾，例如十億節點、千億邊規模的圖結構，運行演算法時能以Spark GraphX三分之一的計算資源，達到十倍處理性能。</p>
<p> <amp-img src="http://p1.pstatp.com/large/pgc-image/RlIbPg6CKw1Jts" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p1.pstatp.com/large/pgc-image/RlIbPg6CKw1Jts" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖16 圖計算性能對比</p>
<p>除了技術功能上的完善，Angel在社區生態上也日趨成熟。據了解，在全行業Angel擁有超過 100家公司和機構用戶，其中包括<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">微博</i>、華為、微眾銀行、小米、滴滴等大型互聯網企業。基於Angel構建的一站式機器學習應用平台智能鈦TI，支持了包括<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">微信</i>支付、騰訊廣告、微視等在內的諸多騰訊內部產品，同時也通過騰訊雲對外開放為更多行業企業提供服務。</p>
<p>截止目前，Angel在GitHub上已經獲得了5500 Star，1400 Fork，在技術、應用、生態等方面的優秀表現均得到了開源社區的認可。此前在騰訊2019 Techo開發者大會上，蔣傑還宣布了資源管理平台核心TKE和分散式資料庫TBase的正式開源。騰訊正在成為大數據領域開源最全面的公司。</p>
<p><strong class="highlight-text">四、Angel使用情況</strong></p>
<p>如圖3所示，在過去12個月，Angel在騰訊內部的任務數量有了非常明顯的增長，增幅達到150%。值得一提的是，Spark On Angel的任務數增長了10倍，為了讓Spark On Angel更加的易用，3.0版本對Spark On Angel做了大幅度升級。在騰訊內部，使用Angel的業務包括騰訊視頻，騰訊新聞和<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">微信</i>等。</p>
<p> <amp-img src="http://p1.pstatp.com/large/pgc-image/Ra9O8NkHj3FcAD" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p1.pstatp.com/large/pgc-image/Ra9O8NkHj3FcAD" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖 17 騰訊內部Angel任務數</p>
<p>Angel官方維護了一個<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">QQ</i>群與外部開發者進行交流，對群用戶的統計表明：</p>
<ul>
<li>
<p>Angel的絕大部分用戶來自中國，主要分布在北京，上海，杭州，成都和深圳等互聯網行業比較發達的城市。</p>
</li>
<li>
<p>有超過100家的公司和科研機構在使用或測試Angel，其中包括了中國最頂級的IT公司：<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">微博</i>，華為和百度等。</p>
</li>
</ul>
<p> <amp-img src="http://p3.pstatp.com/large/pgc-image/Ra9O8O4FOI1wPt" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p3.pstatp.com/large/pgc-image/Ra9O8O4FOI1wPt" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖 18 Angel開源用戶</p>

<h2>五、案例</h2>
<h2></h2>
<p><strong>1、騰訊短視頻推薦</strong></p>
<p> <amp-img src="http://p1.pstatp.com/large/pgc-image/Ra369Jn1MDzkm4" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p1.pstatp.com/large/pgc-image/Ra369Jn1MDzkm4" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖 19 短視頻推薦數據處理流程</p>
<p>上圖所示是騰訊短視頻部門的一個使用案例。用戶的視頻播放日誌和上下文信息被實時轉發給Kafka，流數據引擎Storm訂閱Kafka的數據。Storm是一個實時的特徵生成器，它從一個離線的key-value存儲中獲得用戶畫像和視頻信息，將兩者拼接起來生成特徵。生成的特徵被傳輸到在線訓練系統中來更新在線模型；同時，這些特徵也被轉存到HDFS作為離線訓練的輸入。離線模型通常用來初始化在線訓練系統，當出現異常時，離線模型還可以用來重置在線系統。本案例用到的推薦演算法是FM，訓練樣本24億條，特徵維度為63611，在Spark上訓練耗時10多個小時，應用Angel後減少至1小時。</p>
<h2></h2>
<p><strong>2、金融反欺詐</strong></p>
<p> <amp-img src="http://p1.pstatp.com/large/pgc-image/Ra369XeFlbP00y" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" object-fit="contain" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="http://p1.pstatp.com/large/pgc-image/Ra369XeFlbP00y" alt="《騰訊Angel升級：加入圖演算法，支持十億節點、千億邊規模！中國首個畢業於Linux AI基金會的開源項目》" width="600" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height"></noscript></amp-img></p>
<p class="pgc-img-caption">圖 19 金融反欺詐數據處理流程</p>
<p>金融欺詐檢測是大規模圖學習的常見案例，其網路數據是異構的，包含幾種不同類型的邊：</p>
<ul>
<li>
<p>交易關係: 用戶A和用戶B之間如存在交易關係表明他們之間曾出現過交易行為</p>
</li>
<li>
<p>設備關係：用戶A和用戶B之間如存在設備關係表明他們曾共享過同一個設備</p>
</li>
<li>
<p>Wi-Fi關係：用戶A和用戶B之間如存在Wi-Fi關係表明他們曾通過一個Wi-Fi連接到互聯網</p>
</li>
</ul>
<p>金融詐騙者通常共享設備和Wi-Fi，通過擴展邊緣關係生成社區。Angel上的fast unfolding演算法可以有效地發現這些社區。下游的欺詐風險模型可以將這些社區的用戶畫像和網路特徵作為輸入來學習和推到反欺詐策略。該圖數據包含15億個節點和200億條邊，基於Spark GraphX的實現耗時20小時，而Angel僅需5小時。</p>

<h2>小結</h2>
<p>本文主要介紹了Angel在騰訊內外的使用情況和3.0版本的新特性。</p>
<p>Angel在騰訊內外的使用情況：</p>
<ul>
<li>
<p>騰訊內部：用戶數和任務數增加1.5倍</p>
</li>
<li>
<p>騰訊外部：超過100多家公司和機構使用Angel</p>
</li>
<li>
<p>開源貢獻：4200多個star, 8個子項目，1100多個fork，2000多次commits</p>
</li>
</ul>
<p>Angel 3.0新特性：</p>
<ul>
<li>
<p>自動特徵工程：新增特徵選擇和組合方法，將特徵合成、選擇和重新索引以pipeline的形式呈現，用來迭代生成高階合成特徵</p>
</li>
<li>
<p>新的計算引擎：</p>
</li>
<li>
<p>SONA(加強):特徵工程支持索引為Long類型的向量；所有的演算法被封裝成Spark風格的APIs；SONA上的演算法可以作為Spark的補充</p>
</li>
<li>
<p>PyTONA(新）：PyTONA作為圖學習演算法的引擎被引入，目前支持GCN和GraphSage，同時也支持推薦領域的演算法。PyTONA採用Python作為交互，因此是用戶友好的</p>
</li>
<li>
<p>自動機器學習:Angel3.0引入了3種超參數調節演算法：網格<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">搜索</i>、隨機<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">搜索</i>和貝葉斯優化</p>
</li>
<li>
<p>Angel模型服務：Angel提供一個跨平台的模型服務框架，支持Angel、PyTorch和Spark的模型，性能上與TensorFlow Serving相當</p>
</li>
<li>
<p>支持Kubernetes:Angel3.0支持Kubernetes，從而可以在雲上運行</p>
</li>
</ul>
</div>
	</div>

	<footer class="amp-wp-article-footer">
			<div class="amp-wp-meta amp-wp-tax-category">
		分類: <a href="https://daynews.cc/technology/" rel="category tag">科技</a>	</div>

		<div class="amp-wp-meta amp-wp-comments-link">
		<a href="https://daynews.cc/technology/26515/#comments">
			寫評論		</a>
	</div>
	</footer>
</article>

<footer class="amp-wp-footer">
	<div>
		<h2>天天要聞</h2>
		<a href="#top" class="back-to-top">返回頂部</a>
	</div>
</footer>


<amp-analytics id="354f0d2beeef" type="baiduanalytics"><script type="application/json">{"vars":{"token":"882f12dcdadf8f87fabf76b550649115"},"triggers":{"trackPageview":{"on":"visible","request":"pageview"}}}</script></amp-analytics>
</body>
</html>
<!-- This is the static html file -->